{"version":3,"sources":["webpack:///./gridSizerTemplate.hbs","webpack:///./apiService.js","webpack:///./index.js","webpack:///./cardTemplate.hbs"],"names":["Handlebars","module","exports","template","container","depth0","helpers","partials","data","apiService","proxy","baseUrl","key","query","page","per_page","last_page","get","url","this","fetch","response","json","hits","length","asyncFetchImages","refs","body","document","querySelector","form","gallery","galleryWrap","nextPageBtn","sentinel","modal","modalImage","modalInfo","indexCount","defaults","styling","icons","delay","io","IntersectionObserver","entries","observer","forEach","entry","isIntersecting","createGalleryList","rootMargin","threshold","masonryInstance","Masonry","columnWidth","percentPosition","stagger","visibleStyle","transform","opacity","hiddenStyle","images","markup","map","image","index","cardTemplate","join","imageList","createElement","innerHTML","imageListItems","querySelectorAll","append","imagesLoaded","on","layout","appended","pnotifyMessage","lastPage","proxyEl","classList","add","textContent","appendChild","e","success","text","onGalleryClick","event","target","nodeName","window","addEventListener","listener","addModalClass","onModalClick","removeModalClass","onModalClose","prevImageSrc","code","dataset","Number","source","src","nextImageSrc","nextImageOnGallery","removeEventListener","remove","value","preventDefault","modalWrap","removeChild","li","gridSizerTemplate","items","createGridSizer","setTimeout","observe","alias1","lambda","alias2","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call"],"mappings":"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","file":"main.380814131f786cbbbedb.js","sourcesContent":["var Handlebars = require(\"../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    return \"<li class=\\\"grid-sizer\\\"></li>\";\n},\"useData\":true});","const apiService = {\n    proxy: 'https://cors-anywhere.herokuapp.com/',\n    baseUrl: 'https://pixabay.com/api/',\n    key: '17512246-8cb81e257606609dfb7634e3b',\n    query: '',\n    page: 1,\n    per_page: 12,\n    last_page: false,\n    get() {\n        const url = `${this.baseUrl}?key=${this.key}&q=${this.query}&page=${this.page}&per_page=${this.per_page}`;\n\n        if (this.last_page) {\n            return;\n        }\n\n        this.page += 1;\n\n        const asyncFetchImages = async() => {\n            try {\n                const response = await fetch(url);\n                const data = await response.json();\n                if (data.hits.length < this.per_page) {\n                    this.page = 1;\n                    this.last_page = true;\n                }\n                return data.hits;\n            } catch (error) {\n                throw error;\n            }\n        };\n\n        return asyncFetchImages();\n    },\n};\n\nexport default apiService;","import './styles.css';\r\nimport apiService from './apiService';\r\nimport cardTemplate from './cardTemplate.hbs';\r\nimport gridSizerTemplate from './gridSizerTemplate.hbs';\r\nimport '@pnotify/core/dist/PNotify.css';\r\nimport { defaults } from '@pnotify/core';\r\nimport { alert, notice, info, success, error } from '@pnotify/core';\r\nimport '@pnotify/core/dist/Material.css';\r\nimport 'material-design-icons/iconfont/material-icons.css';\r\nimport Masonry from 'masonry-layout';\r\nimport imagesLoaded from 'imagesloaded';\r\n\r\nconst refs = {\r\n    body: document.querySelector('body'),\r\n    form: document.querySelector('#search-form'),\r\n    gallery: document.querySelector('.gallery'),\r\n    galleryWrap: document.querySelector('.gallery-wrap'),\r\n    nextPageBtn: document.querySelector('button[name=\"load-more\"]'),\r\n    sentinel: document.querySelector('.sentinel'),\r\n    modal: document.querySelector('.js-lightbox'),\r\n    modalImage: document.querySelector('.lightbox__image'),\r\n    modalInfo: document.querySelector('.lightbox__info'),\r\n};\r\n\r\nlet indexCount = 0;\r\n\r\ndefaults.styling = 'material';\r\ndefaults.icons = 'material';\r\ndefaults.delay = 2000;\r\n\r\nconst options = {\r\n    rootMargin: '200px',\r\n    threshold: 1.0,\r\n};\r\n\r\nconst onEntry = (entries, observer) => {\r\n    entries.forEach(entry => {\r\n        if (apiService.last_page) {\r\n            return;\r\n        }\r\n\r\n        if (entry.isIntersecting) {\r\n            createGalleryList();\r\n        }\r\n    });\r\n};\r\n\r\nconst io = new IntersectionObserver(onEntry, options);\r\n\r\nconst masonryInstance = new Masonry(refs.gallery, {\r\n    columnWidth: '.grid-sizer',\r\n    percentPosition: true,\r\n    stagger: 30,\r\n    visibleStyle: { transform: 'translateY(0)', opacity: 1 },\r\n    hiddenStyle: { transform: 'translateY(100px)', opacity: 0 },\r\n});\r\n\r\nconst createGalleryList = async() => {\r\n    const images = await apiService.get();\r\n    const markup = images\r\n        .map(image => {\r\n            image.index = indexCount;\r\n            indexCount += 1;\r\n            return cardTemplate(image);\r\n        })\r\n        .join('');\r\n\r\n    const imageList = document.createElement('ul');\r\n    imageList.innerHTML = markup;\r\n\r\n    const imageListItems = imageList.querySelectorAll('li');\r\n\r\n    refs.gallery.append(...imageListItems);\r\n\r\n    const imagesLoadedInstance = imagesLoaded(refs.gallery);\r\n\r\n    imagesLoadedInstance.on('progress', () => {\r\n        masonryInstance.layout();\r\n    });\r\n\r\n    masonryInstance.appended(imageListItems);\r\n\r\n    pnotifyMessage(1);\r\n    if (apiService.last_page) {\r\n        lastPage();\r\n    }\r\n};\r\n\r\nrefs.form.addEventListener('keydown', onQuery);\r\n\r\nfunction onQuery(event) {\r\n    apiService.query = event.target.value;\r\n\r\n    if (event.key === 'Enter' && apiService.query !== '') {\r\n        event.preventDefault();\r\n        apiService.page = 1;\r\n        indexCount = 0;\r\n        apiService.last_page = false;\r\n        refs.gallery.innerHTML = '';\r\n\r\n        if (typeof refs.modalWrap === 'object') {\r\n            removeModal();\r\n        }\r\n        cteateModal();\r\n\r\n        refs.gallery.addEventListener('click', onGalleryClick);\r\n\r\n        refs.modal.addEventListener('click', onModalClick);\r\n\r\n        createGridSizer();\r\n\r\n        createGalleryList();\r\n\r\n        setTimeout(() => {\r\n            io.observe(refs.sentinel);\r\n        }, 1000);\r\n\r\n        event.target.value = '';\r\n    }\r\n}\r\n\r\nfunction createGridSizer() {\r\n    const columnValue = [1, 2, 3];\r\n\r\n    const markup = columnValue.map(li => gridSizerTemplate(li)).join('');\r\n\r\n    const proxyEl = document.createElement('div');\r\n    proxyEl.innerHTML = markup;\r\n\r\n    const items = proxyEl.querySelectorAll('.grid-sizer');\r\n\r\n    refs.gallery.append(...items);\r\n\r\n    masonryInstance.appended(items);\r\n}\r\n\r\nfunction lastPage() {\r\n    const proxyEl = document.createElement('p');\r\n    proxyEl.classList.add('infinite-scroll-last');\r\n    proxyEl.textContent = 'End of content. No more pages to load';\r\n    refs.gallery.appendChild(proxyEl);\r\n}\r\n\r\nfunction pnotifyMessage(e) {\r\n    if (e === 1) {\r\n        const mySuccess =\r\n            apiService.page === 2 || (apiService.page === 1 && apiService.last_page) ?\r\n            success({\r\n                text: `Yor ${apiService.query} loaded Success!`,\r\n            }) :\r\n            success({\r\n                text: 'The Scrolling Success!',\r\n            });\r\n    }\r\n\r\n    if (apiService.last_page) {\r\n        success({\r\n            text: 'End of content. No more pages to load',\r\n        });\r\n    }\r\n}\r\n\r\nfunction onGalleryClick(event) {\r\n    if (event.target.nodeName !== 'IMG') {\r\n        return;\r\n    }\r\n\r\n    onModalOpen();\r\n    addModalClass();\r\n}\r\n\r\nfunction onModalClick(event) {\r\n    if (event.target.nodeName === 'BUTTON' || event.target.nodeName !== 'IMG') {\r\n        removeModalClass();\r\n        onModalClose();\r\n    }\r\n}\r\n\r\nfunction listener(event) {\r\n    if (event.code === 'ArrowLeft' && refs.modalImage.dataset.index > 0) {\r\n        prevImageOnGallery();\r\n    }\r\n    if (\r\n        event.code === 'ArrowRight' &&\r\n        refs.modalImage.dataset.index < indexCount - 1\r\n    ) {\r\n        nextImageOnGallery();\r\n    }\r\n    if (event.code === 'Escape') {\r\n        removeModalClass();\r\n        onModalClose();\r\n    }\r\n}\r\n\r\nfunction onModalOpen() {\r\n    window.addEventListener('keydown', listener);\r\n}\r\n\r\nfunction onModalClose() {\r\n    window.removeEventListener('keydown', listener);\r\n}\r\n\r\nfunction addModalClass() {\r\n    const src = event.target.dataset.source;\r\n    const index = event.target.dataset.index;\r\n    refs.modal.classList.add('is-open');\r\n    refs.modalImage.src = src;\r\n    refs.modalImage.dataset.index = index;\r\n    const images = refs.gallery.querySelectorAll('img');\r\n    refs.modalInfo.textContent = `${Number(index) + 1}/${images.length}`;\r\n}\r\n\r\nfunction removeModalClass() {\r\n    refs.modal.classList.remove('is-open');\r\n    refs.modalImage.src = '/';\r\n    refs.modalImage.dataset.index = '';\r\n}\r\n\r\nfunction prevImageOnGallery() {\r\n    const index = Number(refs.modalImage.dataset.index);\r\n    const images = refs.gallery.querySelectorAll('img');\r\n    const prevImageSrc = images[index - 1].dataset.source;\r\n    refs.modalImage.src = prevImageSrc;\r\n    refs.modalImage.dataset.index = index - 1;\r\n    refs.modalInfo.textContent = `${index}/${images.length}`;\r\n}\r\n\r\nfunction nextImageOnGallery() {\r\n    const index = Number(refs.modalImage.dataset.index);\r\n    const images = refs.gallery.querySelectorAll('img');\r\n    const nextImageSrc = images[index + 1].dataset.source;\r\n    refs.modalImage.src = nextImageSrc;\r\n    refs.modalImage.dataset.index = index + 1;\r\n    refs.modalInfo.textContent = `${index + 2}/${images.length}`;\r\n}\r\n\r\nfunction cteateModal() {\r\n    refs.modalWrap = document.createElement('div');\r\n    refs.modalWrap.classList.add('modalWrap');\r\n    refs.modalWrap.innerHTML = `<div class=\"lightbox js-lightbox\">\r\n    <div class=\"lightbox__overlay\"></div>\r\n\r\n    <div class=\"lightbox__content\">\r\n        <img class=\"lightbox__image\" src=\"/\" alt=\"\" />\r\n    </div>\r\n\r\n    <button type=\"button\" class=\"lightbox__button\" data-action=\"close-lightbox\"></button>\r\n    <span class=\"lightbox__info\"></span>\r\n</div>`;\r\n    refs.body.appendChild(refs.modalWrap);\r\n    refs.modal = document.querySelector('.js-lightbox');\r\n    refs.modalImage = document.querySelector('.lightbox__image');\r\n    refs.modalInfo = document.querySelector('.lightbox__info');\r\n}\r\n\r\nfunction removeModal() {\r\n    refs.body.removeChild(refs.modalWrap);\r\n}","var Handlebars = require(\"../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var alias1=container.lambda, alias2=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"\\n<li class=\\\"grid-item\\\">\\n      <img src=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0), depth0))\n    + \"\\\" data-source=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"largeImageURL\") : depth0), depth0))\n    + \"\\\" data-index=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"index\") : depth0), depth0))\n    + \"\\\"/>\\n  </li>\\n\\n\\n\";\n},\"useData\":true});"],"sourceRoot":""}