{"version":3,"sources":["webpack:///./gridSizerTemplate.hbs","webpack:///./apiService.js","webpack:///./index.js","webpack:///./cardTemplate.hbs"],"names":["Handlebars","module","exports","template","container","depth0","helpers","partials","data","apiService","proxy","baseUrl","key","query","page","per_page","last_page","get","url","this","fetch","response","json","hits","length","asyncFetchImages","refs","body","document","querySelector","form","gallery","galleryWrap","nextPageBtn","sentinel","modal","modalImage","modalInfo","defaults","styling","icons","delay","io","IntersectionObserver","entries","observer","forEach","entry","isIntersecting","createGalleryList","rootMargin","threshold","masonryInstance","Masonry","columnWidth","percentPosition","stagger","visibleStyle","transform","opacity","hiddenStyle","images","markup","map","image","cardTemplate","join","imageList","createElement","innerHTML","imageListItems","querySelectorAll","append","imagesLoaded","on","layout","appended","pnotifyMessage","lastPage","proxyEl","classList","add","textContent","appendChild","e","success","text","listener","event","index","prevImageSrc","code","dataset","Number","source","src","children","nextImageSrc","nextImageOnGallery","removeModalClass","onModalClose","window","removeEventListener","addModalClass","target","i","remove","addEventListener","value","preventDefault","li","gridSizerTemplate","items","createGridSizer","setTimeout","observe","nodeName","alias1","lambda","alias2","escapeExpression","lookupProperty","parent","propertyName","Object","prototype","hasOwnProperty","call"],"mappings":"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","file":"main.a65d5c0b5d1adc176e2a.js","sourcesContent":["var Handlebars = require(\"../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    return \"<li class=\\\"grid-sizer\\\"></li>\";\n},\"useData\":true});","const apiService = {\n    proxy: 'https://cors-anywhere.herokuapp.com/',\n    baseUrl: 'https://pixabay.com/api/',\n    key: '17512246-8cb81e257606609dfb7634e3b',\n    query: '',\n    page: 1,\n    per_page: 12,\n    last_page: false,\n    get() {\n        const url = `${this.baseUrl}?key=${this.key}&q=${this.query}&page=${this.page}&per_page=${this.per_page}`;\n\n        if (this.last_page) {\n            return;\n        }\n\n        this.page += 1;\n\n        const asyncFetchImages = async() => {\n            try {\n                const response = await fetch(url);\n                const data = await response.json();\n                if (data.hits.length < this.per_page) {\n                    this.page = 1;\n                    this.last_page = true;\n                }\n                return data.hits;\n            } catch (error) {\n                throw error;\n            }\n        };\n\n        return asyncFetchImages();\n    },\n};\n\nexport default apiService;","import './styles.css';\r\nimport apiService from './apiService';\r\nimport cardTemplate from './cardTemplate.hbs';\r\nimport gridSizerTemplate from './gridSizerTemplate.hbs';\r\nimport '@pnotify/core/dist/PNotify.css';\r\nimport { defaults } from '@pnotify/core';\r\nimport { alert, notice, info, success, error } from '@pnotify/core';\r\nimport '@pnotify/core/dist/Material.css';\r\nimport 'material-design-icons/iconfont/material-icons.css';\r\nimport Masonry from 'masonry-layout';\r\nimport imagesLoaded from 'imagesloaded';\r\n\r\nconst refs = {\r\n    body: document.querySelector('body'),\r\n    form: document.querySelector('#search-form'),\r\n    gallery: document.querySelector('.gallery'),\r\n    galleryWrap: document.querySelector('.gallery-wrap'),\r\n    nextPageBtn: document.querySelector('button[name=\"load-more\"]'),\r\n    sentinel: document.querySelector('.sentinel'),\r\n    modal: document.querySelector('.js-lightbox'),\r\n    modalImage: document.querySelector('.lightbox__image'),\r\n    modalInfo: document.querySelector('.lightbox__info'),\r\n};\r\n\r\ndefaults.styling = 'material';\r\ndefaults.icons = 'material';\r\ndefaults.delay = 2000;\r\n\r\nconst options = {\r\n    rootMargin: '200px',\r\n    threshold: 1.0,\r\n};\r\n\r\nconst onEntry = (entries, observer) => {\r\n    entries.forEach(entry => {\r\n        if (apiService.last_page) {\r\n            return;\r\n        }\r\n\r\n        if (entry.isIntersecting) {\r\n            createGalleryList();\r\n        }\r\n    });\r\n};\r\n\r\nconst io = new IntersectionObserver(onEntry, options);\r\n\r\nconst masonryInstance = new Masonry(refs.gallery, {\r\n    columnWidth: '.grid-sizer',\r\n    percentPosition: true,\r\n    stagger: 30,\r\n    visibleStyle: { transform: 'translateY(0)', opacity: 1 },\r\n    hiddenStyle: { transform: 'translateY(100px)', opacity: 0 },\r\n});\r\n\r\nconst createGalleryList = async() => {\r\n    const images = await apiService.get();\r\n    const markup = images.map(image => cardTemplate(image)).join('');\r\n\r\n    const imageList = document.createElement('ul');\r\n    imageList.innerHTML = markup;\r\n\r\n    const imageListItems = imageList.querySelectorAll('li');\r\n\r\n    refs.gallery.append(...imageListItems);\r\n\r\n    const imagesLoadedInstance = imagesLoaded(refs.gallery);\r\n\r\n    imagesLoadedInstance.on('progress', () => {\r\n        masonryInstance.layout();\r\n    });\r\n\r\n    masonryInstance.appended(imageListItems);\r\n\r\n    pnotifyMessage(1);\r\n    if (apiService.last_page) {\r\n        lastPage();\r\n    }\r\n};\r\n\r\nrefs.form.addEventListener('keydown', onQuery);\r\n\r\nfunction onQuery(event) {\r\n    apiService.query = event.target.value;\r\n\r\n    if (event.key === 'Enter' && apiService.query !== '') {\r\n        event.preventDefault();\r\n        apiService.page = 1;\r\n        apiService.last_page = false;\r\n        refs.gallery.innerHTML = '';\r\n\r\n        createGridSizer();\r\n\r\n        createGalleryList();\r\n\r\n        setTimeout(() => {\r\n            io.observe(refs.sentinel);\r\n        }, 1000);\r\n\r\n        event.target.value = '';\r\n    }\r\n}\r\n\r\nrefs.gallery.addEventListener('click', onGalleryClick);\r\n\r\nrefs.modal.addEventListener('click', onModalClick);\r\n\r\nfunction createGridSizer() {\r\n    const columnValue = [1, 2, 3];\r\n\r\n    const markup = columnValue.map(li => gridSizerTemplate(li)).join('');\r\n\r\n    const proxyEl = document.createElement('div');\r\n    proxyEl.innerHTML = markup;\r\n\r\n    const items = proxyEl.querySelectorAll('.grid-sizer');\r\n\r\n    refs.gallery.append(...items);\r\n\r\n    masonryInstance.appended(items);\r\n}\r\n\r\nfunction lastPage() {\r\n    const proxyEl = document.createElement('p');\r\n    proxyEl.classList.add('infinite-scroll-last');\r\n    proxyEl.textContent = 'End of content. No more pages to load';\r\n    refs.gallery.appendChild(proxyEl);\r\n}\r\n\r\nfunction pnotifyMessage(e) {\r\n    if (e === 1) {\r\n        const mySuccess =\r\n            apiService.page === 2 || (apiService.page === 1 && apiService.last_page) ?\r\n            success({\r\n                text: `Yor ${apiService.query} loaded Success!`,\r\n            }) :\r\n            success({\r\n                text: 'The Scrolling Success!',\r\n            });\r\n    }\r\n\r\n    if (apiService.last_page) {\r\n        success({\r\n            text: 'End of content. No more pages to load',\r\n        });\r\n    }\r\n}\r\n\r\nfunction onGalleryClick(event) {\r\n    if (event.target.nodeName !== 'IMG') {\r\n        return;\r\n    }\r\n\r\n    onModalOpen();\r\n    addModalClass();\r\n}\r\n\r\nfunction onModalClick(event) {\r\n    if (event.target.nodeName === 'BUTTON' || event.target.nodeName !== 'IMG') {\r\n        removeModalClass();\r\n        onModalClose();\r\n    }\r\n}\r\n\r\nfunction listener(event) {\r\n    if (event.code === 'ArrowLeft' && refs.modalImage.dataset.index > 0) {\r\n        prevImageOnGallery();\r\n    }\r\n\r\n    if (\r\n        event.code === 'ArrowRight' &&\r\n        refs.modalImage.dataset.index < refs.gallery.children.length - 4\r\n    ) {\r\n        nextImageOnGallery();\r\n    }\r\n    if (event.code === 'Escape') {\r\n        removeModalClass();\r\n        onModalClose();\r\n    }\r\n}\r\n\r\nfunction onModalOpen() {\r\n    window.addEventListener('keydown', listener);\r\n}\r\n\r\nfunction onModalClose() {\r\n    window.removeEventListener('keydown', listener);\r\n}\r\n\r\nfunction addModalClass() {\r\n    const images = refs.gallery.querySelectorAll('img');\r\n    let index;\r\n    const src = event.target.dataset.source;\r\n    refs.modal.classList.add('is-open');\r\n    refs.modalImage.src = src;\r\n    images.forEach((image, i) => {\r\n        if (image.dataset.source === refs.modalImage.src) {\r\n            index = i;\r\n        }\r\n    });\r\n\r\n    refs.modalImage.dataset.index = index;\r\n    refs.modalInfo.textContent = `${Number(index) + 1}/${images.length}`;\r\n}\r\n\r\nfunction removeModalClass() {\r\n    refs.modal.classList.remove('is-open');\r\n    refs.modalImage.src = '/';\r\n    refs.modalImage.dataset.index = '';\r\n}\r\n\r\nfunction prevImageOnGallery() {\r\n    const index = Number(refs.modalImage.dataset.index);\r\n    const images = refs.gallery.querySelectorAll('img');\r\n    const prevImageSrc = images[index - 1].dataset.source;\r\n    refs.modalImage.src = prevImageSrc;\r\n    refs.modalImage.dataset.index = index - 1;\r\n    refs.modalInfo.textContent = `${index}/${images.length}`;\r\n}\r\n\r\nfunction nextImageOnGallery() {\r\n    const index = Number(refs.modalImage.dataset.index);\r\n    const images = refs.gallery.querySelectorAll('img');\r\n    const nextImageSrc = images[index + 1].dataset.source;\r\n    refs.modalImage.src = nextImageSrc;\r\n    refs.modalImage.dataset.index = index + 1;\r\n    refs.modalInfo.textContent = `${index + 2}/${images.length}`;\r\n}","var Handlebars = require(\"../node_modules/handlebars/runtime.js\");\nfunction __default(obj) { return obj && (obj.__esModule ? obj[\"default\"] : obj); }\nmodule.exports = (Handlebars[\"default\"] || Handlebars).template({\"compiler\":[8,\">= 4.3.0\"],\"main\":function(container,depth0,helpers,partials,data) {\n    var alias1=container.lambda, alias2=container.escapeExpression, lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    };\n\n  return \"\\n<li class=\\\"grid-item\\\">\\n      <img src=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"webformatURL\") : depth0), depth0))\n    + \"\\\" data-source=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"largeImageURL\") : depth0), depth0))\n    + \"\\\" data-index=\\\"\"\n    + alias2(alias1((depth0 != null ? lookupProperty(depth0,\"index\") : depth0), depth0))\n    + \"\\\"/>\\n  </li>\\n\\n\\n\";\n},\"useData\":true});"],"sourceRoot":""}